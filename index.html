<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>JPM Interview Prep App v5.0 (Resilient)</title>
    
    <!-- Dependencies -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { jpm: { primary: '#0f4c81', dark: '#1e3a5f', light: '#e0f2fe', accent: '#00a1de' } }
                }
            }
        }
    </script>
    <style>
        body { background-color: #f3f4f6; overflow: hidden; font-family: 'Segoe UI', sans-serif; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* 3D FLIP ANIMATION */
        .card-scene { perspective: 1000px; width: 100%; height: 400px; }
        .card-object { width: 100%; height: 100%; position: relative; transition: transform 0.6s; transform-style: preserve-3d; cursor: pointer; }
        .card-face { position: absolute; height: 100%; width: 100%; backface-visibility: hidden; -webkit-backface-visibility: hidden; border-radius: 1rem; display: flex; flex-direction: column; overflow: hidden; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        .card-content { flex-grow: 1; overflow-y: auto; padding: 2rem; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
        .card-face.front { background: white; border: 2px solid #e5e7eb; transform: rotateY(0deg); }
        .card-face.back { background: #f0fdf4; border: 2px solid #86efac; transform: rotateY(180deg); }
        .is-flipped { transform: rotateY(180deg); }
        
        .slide-in { animation: slideIn 0.3s ease-out forwards; }
        @keyframes slideIn { from { transform: translateX(-100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- CORE UTILS ---
        
        // 1. SMART PARSER (Supports Pipe '|' and Comma ',')
        const parseCSV = (text) => {
            if (!text) return [];
            if (text.charCodeAt(0) === 0xFEFF) text = text.slice(1); // Remove BOM
            text = text.replace(/\r\n/g, '\n').replace(/\r/g, '\n');
            
            const lines = text.split('\n').filter(l => l.trim().length > 0);
            if (lines.length === 0) return [];

            // Detect Delimiter based on header
            const headerLine = lines[0];
            const delimiter = headerLine.includes('|') ? '|' : ',';
            
            const headers = headerLine.split(delimiter).map(h => h.trim());

            return lines.slice(1).map((line, idx) => {
                // Handle split but respect quotes only if comma mode, pipe mode is strict split
                let values;
                if (delimiter === '|') {
                    values = line.split('|');
                } else {
                    // Legacy Regex for Comma
                    values = line.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g) || [];
                }

                const entry = { id: `row-${idx}` };
                headers.forEach((h, i) => {
                    let val = values[i] || '';
                    val = val.trim();
                    if (val.startsWith('"') && val.endsWith('"')) val = val.substring(1, val.length - 1);
                    entry[h] = val.replace(/""/g, '"');
                });
                return entry;
            });
        };

        const calculateSimilarity = (s1, s2) => {
            if (!s1 || !s2) return 0;
            const a = s1.toLowerCase(), b = s2.toLowerCase();
            if (a.length === 0) return 0;
            const matrix = Array(b.length + 1).fill(null).map((_, i) => Array(a.length + 1).fill(null).map((_, j) => i === 0 ? j : (j === 0 ? i : 0)));
            for (let i = 1; i <= b.length; i++) {
                for (let j = 1; j <= a.length; j++) {
                    matrix[i][j] = b[i-1] === a[j-1] ? matrix[i-1][j-1] : Math.min(matrix[i-1][j], matrix[i][j-1], matrix[i-1][j-1]) + 1;
                }
            }
            return Math.round((1 - matrix[b.length][a.length] / Math.max(a.length, b.length)) * 100);
        };

        const shuffleArray = (array) => {
            let arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        };

        // --- COMPONENTS ---

        const Dashboard = ({ active, stats, timer }) => {
            const accuracy = stats.total > 0 ? Math.round((stats.correct / stats.total) * 100) : 0;
            return (
                <div className={`fixed inset-y-0 left-0 w-64 bg-white shadow-2xl z-20 flex flex-col transition-transform duration-300 border-r border-gray-200 ${active ? 'translate-x-0' : '-translate-x-full'}`}>
                    <div className="p-6 bg-jpm-primary text-white">
                        <h2 className="text-xl font-bold"><i className="fas fa-chart-pie mr-2"></i> Dashboard</h2>
                    </div>
                    <div className="p-6 space-y-6">
                        <div className="bg-gray-50 p-4 rounded-lg border">
                            <p className="text-xs text-gray-500 font-bold uppercase">Timer</p>
                            <p className="text-3xl font-mono text-jpm-dark">{Math.floor(timer/60).toString().padStart(2,'0')}:{(timer%60).toString().padStart(2,'0')}</p>
                        </div>
                        <div>
                            <div className="flex justify-between text-sm font-bold text-gray-700"><span>Accuracy</span><span>{accuracy}%</span></div>
                            <div className="w-full bg-gray-200 rounded-full h-2.5 mt-1">
                                <div className={`h-2.5 rounded-full transition-all duration-500 ${accuracy > 70 ? 'bg-green-500' : 'bg-orange-500'}`} style={{width: `${accuracy}%`}}></div>
                            </div>
                        </div>
                        <div className="grid grid-cols-2 gap-2">
                            <div className="bg-green-50 p-2 rounded text-center border border-green-100">
